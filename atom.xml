<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>PHP</title>
  <id>http://aiqiyi.github.io/</id>
  <updated>2016-03-24T10:58:02+08:00</updated>
  <subtitle>____phper</subtitle>
  <link href="http://aiqiyi.github.io/"></link>
  <author>
    <name>PHP</name>
  </author>
  <entry>
    <title>PHPExcel 用法详解</title>
    <updated>2016-03-24T10:08:00+08:00</updated>
    <id>tag:aiqiyi.github.io,2016-03-24:/ink-blog-phpexcel.html</id>
    <content type="html">&lt;h4&gt;（1）require&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;require_once &#39;./phpexcel/PHPExcel.php&#39;;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//设定时区&#xA;date_default_timezone_set(&#39;PRC&#39;); &#xA;//创建一个新的对象  PHPExcel object&#xA;$objPHPExcel = new PHPExcel();&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（2）文件属性，全局属性&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;// 设置文件的一些属性，在xls文件——&amp;gt;属性——&amp;gt;详细信息里可以看到这些值，xml表格里是没有这些值的&#xA;$objPHPExcel&#xA;      -&amp;gt;getProperties()  //获得文件属性对象，给下文提供设置资源&#xA;      -&amp;gt;setCreator( &amp;quot;Maarten Balliauw&amp;quot;)                 //设置文件的创建者&#xA;      -&amp;gt;setLastModifiedBy( &amp;quot;Maarten Balliauw&amp;quot;)          //设置最后修改者&#xA;      -&amp;gt;setTitle( &amp;quot;Office 2007 XLSX Test Document&amp;quot; )    //设置标题&#xA;      -&amp;gt;setSubject( &amp;quot;Office 2007 XLSX Test Document&amp;quot; )  //设置主题&#xA;      //设置备注&#xA;      -&amp;gt;setDescription( &amp;quot;Test document for Office 2007 XLSX, generated using PHP classes.&amp;quot;) &#xA;      -&amp;gt;setKeywords( &amp;quot;office 2007 openxml php&amp;quot;)        //设置标记&#xA;      -&amp;gt;setCategory( &amp;quot;Test result file&amp;quot;);                //设置类别&#xA;&#xA;$objPHPExcel-&amp;gt;getDefaultStyle()-&amp;gt;getFont()-&amp;gt;setName( &#39;Arial&#39;); //默认的字体&#xA;$objPHPExcel-&amp;gt;getDefaultStyle()-&amp;gt;getFont()-&amp;gt;setName(iconv(&#39;gbk&#39;, &#39;utf-8&#39;, &#39;宋体&#39;));&#xA;$objPHPExcel-&amp;gt;getDefaultStyle()-&amp;gt;getFont()-&amp;gt;setSize(20); //文字大小&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（3）表格设定&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;// 给表格添加数据&#xA;//设置第一个内置表（一个xls文件里可以有多个表）为活动的&#xA;$objPHPExcel-&amp;gt;setActiveSheetIndex(0)             &#xA;            -&amp;gt;setCellValue( &#39;A1&#39;, &#39;Hello&#39; )         //给表的单元格设置数据&#xA;            -&amp;gt;setCellValue( &#39;B2&#39;, &#39;world!&#39; )      //数据格式可以为字符串&#xA;            -&amp;gt;setCellValue( &#39;C1&#39;, 12)            //数字型&#xA;            -&amp;gt;setCellValue( &#39;D2&#39;, 12)            //&#xA;            -&amp;gt;setCellValue( &#39;D3&#39;, true )           //布尔型&#xA;            -&amp;gt;setCellValue( &#39;D4&#39;, &#39;=SUM(C1:D2)&#39; );//公式&#xA;//循环添加&#xA;for($i = 1;$i&amp;lt;200;$i++) {&#xA;  $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;A&#39; . $i, $i);&#xA;  $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;B&#39; . $i, &#39;Test value&#39;);&#xA;}&#xA;&#xA;//得到当前活动的表,注意下文教程中会经常用到$objActSheet&#xA;$objActSheet = $objPHPExcel-&amp;gt;getActiveSheet();&#xA;//  $objPHPExcel-&amp;gt;getActiveSheet()  ==  $objActSheet&#xA;//设置行高 -1自动调整行高（别的值则为行高）&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getRowDimension(8)-&amp;gt;setRowHeight(-1); &#xA;//设置一列的宽度&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getColumnDimension(&#39;A&#39;)-&amp;gt;setWidth(15); &#xA;//内容自适应&#xA;                  $objActSheet-&amp;gt;getColumnDimension(&#39;B&#39;)-&amp;gt;setAutoSize(true);   &#xA;&#xA;$dateTimeNow = time();//获得秒值变量&#xA;//三个表格分别设置为当前实际的 日期格式、时间格式、日期和时间格式&#xA;/*首先将单元格的值设置为由PHPExcel_Shared_Date::PHPToExcel方法转换后的excel格式的值&#xA;然后用过得到该单元格的样式里面数字样式再设置显示格式*/&#xA;$objActSheet-&amp;gt;setCellValue( &#39;C9&#39;, PHPExcel_Shared_Date::PHPToExcel( $dateTimeNow )); &#xA;$objActSheet-&amp;gt;getStyle( &#39;C9&#39;)-&amp;gt;getNumberFormat()&#xA;                    -&amp;gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_DATE_YYYYMMDD2);&#xA;$objActSheet-&amp;gt;setCellValue( &#39;C10&#39;, PHPExcel_Shared_Date::PHPToExcel( $dateTimeNow ));&#xA;&#xA;$objActSheet-&amp;gt;getStyle( &#39;C10&#39;)-&amp;gt;getNumberFormat()&#xA;                    -&amp;gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_DATE_TIME4);&#xA;$objActSheet-&amp;gt;setCellValue( &#39;C10&#39;, PHPExcel_Shared_Date::PHPToExcel( $dateTimeNow ));&#xA;&#xA;$objActSheet-&amp;gt;getStyle( &#39;C10&#39;)-&amp;gt;getNumberFormat()&#xA;                    -&amp;gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_DATE_TIME4);&#xA;//将E4到E13的数字格式设置为EUR&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;E4:E13&#39;)-&amp;gt;getNumberFormat()-&amp;gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_EUR_SIMPLE);&#xA;&#xA;&#xA;/*设置打印时候的页眉页脚（设置完了以后可以通过打印预览来看效果）&#xA;    字符串中的&amp;amp;*好像是一些变量*/&#xA;$objActSheet-&amp;gt;getHeaderFooter()&#xA;                -&amp;gt;setOddHeader( &#39;&amp;amp;L&amp;amp;G&amp;amp;C&amp;amp;HPlease treat this document as confidential!&#39;);&#xA;$objActSheet-&amp;gt;getHeaderFooter()&#xA;                -&amp;gt;setOddFooter( &#39;&amp;amp;L&amp;amp;B&#39; . $objPHPExcel-&amp;gt;getProperties()-&amp;gt;getTitle() . &#39;&amp;amp;RPage &amp;amp;P of &amp;amp;N&#39; );&#xA;&#xA;//设置页面文字的方向和页面大小&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getPageSetup()&#xA;                -&amp;gt;setOrientation(PHPExcel_Worksheet_PageSetup:: ORIENTATION_LANDSCAPE);&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getPageSetup()&#xA;                -&amp;gt;setPaperSize(PHPExcel_Worksheet_PageSetup:: PAPERSIZE_A4);     //A4纸大小&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（3）单元格设定&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//设置单元格的批注&#xA;//设置作者&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getComment( &#39;E13&#39;)-&amp;gt;setAuthor(&#39;PHPExcel&#39; );  &#xA;//添加批注   &#xA;$objCommentRichText = $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getComment(&#39;E13&#39; )-&amp;gt;getText()-&amp;gt;createTextRun(&#39;PHPExcel:&#39;);  &#xA;//将现有批注加粗&#xA;$objCommentRichText-&amp;gt;getFont()-&amp;gt;setBold( true);  &#xA;//添加更多批注&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getComment( &#39;E13&#39;)-&amp;gt;getText()-&amp;gt;createTextRun(&amp;quot;\r\n&amp;quot; );      &#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getComment( &#39;E13&#39;)-&amp;gt;getText()&#xA;                    -&amp;gt;createTextRun(&#39;Total amount on the current invoice, including VAT.&#39; );&#xA;//设置批注显示的宽高 ，在office中有效在wps中无效&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getComment( &#39;E13&#39;)-&amp;gt;setWidth(&#39;100pt&#39; );      &#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getComment( &#39;E13&#39;)-&amp;gt;setHeight(&#39;100pt&#39; );&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getComment( &#39;E13&#39;)-&amp;gt;setMarginLeft(&#39;150pt&#39; );&#xA;//设置背景色 ，在office中有效在wps中无效&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getComment( &#39;E13&#39;)-&amp;gt;getFillColor()-&amp;gt;setRGB(&#39;EEEEEE&#39; );      &#xA;&#xA;//合并拆分单元格&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;mergeCells( &#39;A28:B28&#39;);      // A28:B28合并&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;unmergeCells( &#39;A28:B28&#39;);    // A28:B28再拆分&#xA;&#xA;//单元格密码保护&#xA;//将B1的文字字体设置为Candara，20号的粗体下划线有背景色&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;B1&#39;)-&amp;gt;getFont()-&amp;gt;setName(&#39;Candara&#39; ); //字体设置为Candara&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;B1&#39;)-&amp;gt;getFont()-&amp;gt;setSize(20); //20号字体&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;B1&#39;)-&amp;gt;getFont()-&amp;gt;setBold(true); //粗体&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;B1&#39;)-&amp;gt;getFont()-&amp;gt;setUnderline(PHPExcel_Style_Font::UNDERLINE_SINGLE);//下划线&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;B1&#39;)-&amp;gt;getFont()-&amp;gt;getColor()-&amp;gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE); //背景色&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（4）对其方式&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//文字对齐方式&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;D11&#39;)-&amp;gt;getAlignment()-&amp;gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);    //水平方向上对齐&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;A18&#39;)-&amp;gt;getAlignment()-&amp;gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_JUSTIFY);//水平方向上两端对齐&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;A18&#39;)-&amp;gt;getAlignment()-&amp;gt;setVertical(PHPExcel_Style_Alignment::VERTICAL_CENTER);       //垂直方向上中间居中&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;A3&#39;)-&amp;gt;getAlignment()-&amp;gt;setWrapText(true); &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（5）边框设定&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//设置列边框&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;A4&#39;)-&amp;gt;getBorders()-&amp;gt;getTop()-&amp;gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN); //上边框&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;A10&#39;)-&amp;gt;getBorders()-&amp;gt;getLeft()-&amp;gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN); //左边框&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;E10&#39;)-&amp;gt;getBorders()-&amp;gt;getRight()-&amp;gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);//右边框&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;D13&#39;)-&amp;gt;getBorders()-&amp;gt;getLeft()-&amp;gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THICK);//左边框&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;E13&#39;)-&amp;gt;getBorders()-&amp;gt;getBottom()-&amp;gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THICK);//下边框&#xA;//设置边框颜色&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;D13&#39;)-&amp;gt;getBorders()-&amp;gt;getLeft()-&amp;gt;getColor()-&amp;gt;setARGB(&#39;FF993300&#39;);&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;D13&#39;)-&amp;gt;getBorders()-&amp;gt;getTop()-&amp;gt;getColor()-&amp;gt;setARGB(&#39;FF993300&#39;);&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;D13&#39;)-&amp;gt;getBorders()-&amp;gt;getBottom()-&amp;gt;getColor()-&amp;gt;setARGB(&#39;FF993300&#39;);&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;E13&#39;)-&amp;gt;getBorders()-&amp;gt;getRight()-&amp;gt;getColor()-&amp;gt;setARGB(&#39;FF993300&#39;);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（6）冻结窗格&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//冻结窗格&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;freezePane(&#39;A2&#39;); //冻结窗格A2&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（7）Rows to repeat at top&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//Rows to repeat at top 在顶部重复的行&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getPageSetup()-&amp;gt;setRowsToRepeatAtTopByStartAndEnd(1, 1);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（8）综合设定边框&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//设置单元格边框&#xA;$styleThinBlackBorderOutline = array(&#xA;       &#39;borders&#39; =&amp;gt; array (&#xA;             &#39;outline&#39; =&amp;gt; array (&#xA;                   &#39;style&#39; =&amp;gt; PHPExcel_Style_Border::BORDER_THIN,   //设置border样式&#xA;                   //&#39;style&#39; =&amp;gt; PHPExcel_Style_Border::BORDER_THICK,  另一种样式&#xA;                   &#39;color&#39; =&amp;gt; array (&#39;argb&#39; =&amp;gt; &#39;FF000000&#39;),          //设置border颜色&#xA;            ),&#xA;      ),&#xA;);&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;A4:E10&#39;)-&amp;gt;applyFromArray($styleThinBlackBorderOutline);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（9）设置填充的样式和背景色&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//设置填充的样式和背景色&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;A1:E1&#39;)-&amp;gt;getFill()-&amp;gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID); // 这句不可少&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;A1:E1&#39;)-&amp;gt;getFill()-&amp;gt;getStartColor()-&amp;gt;setARGB(&#39;FF808080&#39;);&#xA;&#xA;//综合设置样例&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;A1:T100&#39;)-&amp;gt;applyFromArray(&#xA;  array(&#39;fill&#39;  =&amp;gt; array(&#xA;                &#39;type&#39;    =&amp;gt; PHPExcel_Style_Fill::FILL_SOLID,&#xA;                &#39;color&#39;   =&amp;gt; array(&#39;argb&#39; =&amp;gt; &#39;FFCCFFCC&#39;)&#xA;              ),&#xA;      &#39;borders&#39; =&amp;gt; array(&#xA;                &#39;bottom&#39;  =&amp;gt; array(&#39;style&#39; =&amp;gt; PHPExcel_Style_Border::BORDER_THIN),&#xA;                &#39;right&#39;   =&amp;gt; array(&#39;style&#39; =&amp;gt; PHPExcel_Style_Border::BORDER_MEDIUM)&#xA;              )&#xA;     )&#xA;  );&#xA;&#xA;//综合设置样例&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;A3:E3&#39;)-&amp;gt;applyFromArray(&#xA;             array(&#xA;                   &#39;font&#39;    =&amp;gt; array (&#xA;                         &#39;bold&#39;      =&amp;gt; true&#xA;                   ),&#xA;                   &#39;alignment&#39; =&amp;gt; array (&#xA;                         &#39;horizontal&#39; =&amp;gt; PHPExcel_Style_Alignment::HORIZONTAL_RIGHT ,&#xA;                  ),&#xA;                   &#39;borders&#39; =&amp;gt; array (&#xA;                         &#39;top&#39;     =&amp;gt; array (&#xA;                               &#39;style&#39; =&amp;gt; PHPExcel_Style_Border::BORDER_THIN&#xA;                        )&#xA;                  ),&#xA;                   &#39;fill&#39; =&amp;gt; array (&#xA;                         &#39;type&#39;       =&amp;gt; PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR ,&#xA;                         &#39;rotation&#39;   =&amp;gt; 90,&#xA;                         &#39;startcolor&#39; =&amp;gt; array (&#xA;                               &#39;argb&#39; =&amp;gt; &#39;FFA0A0A0&#39;&#xA;                         ),&#xA;                         &#39;endcolor&#39;   =&amp;gt; array (&#xA;                               &#39;argb&#39; =&amp;gt; &#39;FFFFFFFF&#39;&#xA;                         )&#xA;                  )&#xA;            )&#xA;);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（10）单元格内容url超链接 &amp;amp;&amp;amp; 图片&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//给单元格内容设置url超链接&#xA;$objActSheet-&amp;gt;getCell(&#39;E26&#39;)-&amp;gt;getHyperlink()-&amp;gt;setUrl( &#39;http://www.phpexcel.net&#39;);    //超链接url地址&#xA;$objActSheet-&amp;gt;getCell(&#39;E26&#39;)-&amp;gt;getHyperlink()-&amp;gt;setTooltip( &#39;Navigate to website&#39;);  //鼠标移上去连接提示信息&#xA;&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;E26&#39;, &#39;www.phpexcel.net&#39;);  &#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getCell(&#39;E26&#39;)-&amp;gt;getHyperlink()-&amp;gt;setUrl(&#39;http://www.phpexcel.net&#39;);  &#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getCell(&#39;E26&#39;)-&amp;gt;getHyperlink()-&amp;gt;setTooltip(&#39;Navigate to website&#39;);  &#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;E26&#39;)-&amp;gt;getAlignment()-&amp;gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);  &#xA;&#xA;&#xA;//给表中添加图片&#xA;$objDrawing = new PHPExcel_Worksheet_Drawing();&#xA;$objDrawing-&amp;gt;setName(&#39;Paid&#39;);&#xA;$objDrawing-&amp;gt;setDescription(&#39;Paid&#39;);&#xA;$objDrawing-&amp;gt;setPath(&#39;./images/paid.png&#39;); //图片引入位置&#xA;$objDrawing-&amp;gt;setCoordinates(&#39;B15&#39;); //图片添加位置&#xA;$objDrawing-&amp;gt;setOffsetX(210);&#xA;$objDrawing-&amp;gt;setRotation(25); &#xA;$objDrawing-&amp;gt;setHeight(36);&#xA;$objDrawing-&amp;gt;getShadow()-&amp;gt;setVisible (true );&#xA;$objDrawing-&amp;gt;getShadow()-&amp;gt;setDirection(45);&#xA;$objDrawing-&amp;gt;setWorksheet($objPHPExcel-&amp;gt;getActiveSheet());&#xA;//还可以添加有gd库生产的图片，详细见自带实例25&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（11）删除和隐藏&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//添加或删除行和列&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;insertNewRowBefore(6, 10);   //在行6前添加10行&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;removeRow(6, 10);                  //从第6行往后删去10行&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;insertNewColumnBefore( &#39;E&#39;, 5);    //从第E列前添加5类&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;removeColumn( &#39;E&#39;, 5);             //从E列开始往后删去5列&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;removeRow(4,1);       //删去第4行&#xA;&#xA;//隐藏和显示某列&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getColumnDimension( &#39;C&#39;)-&amp;gt;setVisible(false);          //隐藏&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getColumnDimension( &#39;D&#39;)-&amp;gt;setVisible(true);           //显示&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（12）重命名&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//重新命名活动的表的标签名称&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setTitle( &#39;Simple&#39;);&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setTitle(iconv(&#39;gbk&#39;, &#39;utf-8&#39;, &#39;phpexcel测试&#39;));&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（13）安全&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//保护cell&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getProtection()-&amp;gt;setSheet(true); // Needs to be set to true in order to enable any worksheet protection!&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;protectCells(&#39;A3:E13&#39;, &#39;PHPExcel&#39;);  //保护单元格，设定密码PHPExcel&#xA;&#xA;//设置工作表的安全&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getProtection()-&amp;gt;setPassword( &#39;PHPExcel&#39;);&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getProtection()-&amp;gt;setSheet( true); // This should be enabled in order to enable any of the following!&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getProtection()-&amp;gt;setSort( true);&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getProtection()-&amp;gt;setInsertRows( true);&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getProtection()-&amp;gt;setFormatCells( true);&#xA;&#xA;//设置文档安全&#xA;$objPHPExcel-&amp;gt;getSecurity()-&amp;gt;setLockWindows( true);&#xA;$objPHPExcel-&amp;gt;getSecurity()-&amp;gt;setLockStructure( true);&#xA;$objPHPExcel-&amp;gt;getSecurity()-&amp;gt;setWorkbookPassword( &amp;quot;PHPExcel&amp;quot;);     //设置密码&#xA;&#xA;&#xA;//设置整张表为只读，然后解锁A2-B2为为受保护的&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getProtection()-&amp;gt;setSheet(true);  &#xA;$objPHPExcel-&amp;gt;getActiveSheet()&#xA;  -&amp;gt;getStyle(&#39;A2:B2&#39;)&#xA;  -&amp;gt;getProtection()-&amp;gt;setLocked(&#xA;    PHPExcel_Style_Protection::PROTECTION_UNPROTECTED&#xA;  );&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（14）样式赋值详解&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//样式赋值详解&#xA;$objConditional1 = new PHPExcel_Style_Conditional();      //实例化&#xA;$objConditional1-&amp;gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_CELLIS)    //设定属性    单元格&#xA;                -&amp;gt;setOperatorType(PHPExcel_Style_Conditional::OPERATOR_BETWEEN)     //设定属性    between&#xA;                -&amp;gt;addCondition(&#39;200&#39;)                                               //200   -   400 之间&#xA;                -&amp;gt;addCondition(&#39;400&#39;);&#xA;$objConditional1-&amp;gt;getStyle()-&amp;gt;getFont()-&amp;gt;getColor()-&amp;gt;setARGB(PHPExcel_Style_Color::COLOR_YELLOW);  //文字颜色    黄色&#xA;$objConditional1-&amp;gt;getStyle()-&amp;gt;getFont()-&amp;gt;setBold(true);                                            //加粗&#xA;$objConditional1-&amp;gt;getStyle()-&amp;gt;getNumberFormat()-&amp;gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_EUR_SIMPLE);   //格式化数字&#xA;&#xA;$objConditional2 = new PHPExcel_Style_Conditional();       //实例化&#xA;$objConditional2-&amp;gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_CELLIS)&#xA;                -&amp;gt;setOperatorType(PHPExcel_Style_Conditional::OPERATOR_LESSTHAN)    //设定属性     lessthan   小于&#xA;                -&amp;gt;addCondition(&#39;0&#39;);                                                //   小于 0 的&#xA;$objConditional2-&amp;gt;getStyle()-&amp;gt;getFont()-&amp;gt;getColor()-&amp;gt;setARGB(PHPExcel_Style_Color::COLOR_RED);       //文字颜色     红色&#xA;$objConditional2-&amp;gt;getStyle()-&amp;gt;getFont()-&amp;gt;setItalic(true);                                            //斜体&#xA;$objConditional2-&amp;gt;getStyle()-&amp;gt;getNumberFormat()-&amp;gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_EUR_SIMPLE);&#xA;&#xA;$objConditional3 = new PHPExcel_Style_Conditional();&#xA;$objConditional3-&amp;gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_CELLIS)&#xA;                -&amp;gt;setOperatorType(PHPExcel_Style_Conditional::OPERATOR_GREATERTHANOREQUAL)   //设定属性     greaterThanOrEqual   大于或者等于&#xA;                -&amp;gt;addCondition(&#39;0&#39;);                                                         //大于等于 0  的&#xA;$objConditional3-&amp;gt;getStyle()-&amp;gt;getFont()-&amp;gt;getColor()-&amp;gt;setARGB(PHPExcel_Style_Color::COLOR_GREEN);      //绿色&#xA;$objConditional3-&amp;gt;getStyle()-&amp;gt;getFont()-&amp;gt;setItalic(true);&#xA;$objConditional3-&amp;gt;getStyle()-&amp;gt;getNumberFormat()-&amp;gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_EUR_SIMPLE);&#xA;&#xA;$conditionalStyles = $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;B2&#39;)-&amp;gt;getConditionalStyles();        //获取B2 的单元格样式  $conditionalStyles&#xA;array_push($conditionalStyles, $objConditional1);                                                   //在$conditionalStyles 后插入$objConditional1样式&#xA;array_push($conditionalStyles, $objConditional2);                                                   //在新的$conditionalStyles 后插入$objConditional2样式&#xA;array_push($conditionalStyles, $objConditional3);                                                   //在新的$conditionalStyles 后插入$objConditional3样式&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;B2&#39;)-&amp;gt;setConditionalStyles($conditionalStyles);           //把样式赋值给  B2&#xA;&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;duplicateConditionalStyle(                                          //  复制 B2 的条件样式风格  至B3-B7&#xA;        $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle(&#39;B2&#39;)-&amp;gt;getConditionalStyles(),&#xA;        &#39;B3:B7&#39;&#xA;        );&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（15）循环数据，分页&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//循环输出 50 条数据&#xA;for ($i = 1; $i &amp;lt;= 50; $i++) {&#xA;  $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;A&#39; . $i, &amp;quot;FName $i&amp;quot;);&#xA;  $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;B&#39; . $i, &amp;quot;LName $i&amp;quot;);&#xA;  $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;C&#39; . $i, &amp;quot;PhoneNo $i&amp;quot;);&#xA;  $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;D&#39; . $i, &amp;quot;FaxNo $i&amp;quot;);&#xA;  $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;E&#39; . $i, true);&#xA;&#xA;  // 每 10 条数据 ， 分页一次（打印预览）&#xA;  if ($i % 10 == 0) {&#xA;    // 增加分页  函数 =》setBreak(&#39;A10&#39;,PHPExcel_Worksheet::BREAK_ROW)&#xA;    $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setBreak( &#39;A&#39; . $i, PHPExcel_Worksheet::BREAK_ROW );&#xA;  }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（16）填充&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//用数组填充表&#xA;//使用数组的内容从A2开始填充&#xA;$dataArray = array( array(&amp;quot;2010&amp;quot; ,    &amp;quot;Q1&amp;quot;,  &amp;quot;United States&amp;quot;,  790),&#xA;                   array(&amp;quot;2010&amp;quot; ,    &amp;quot;Q2&amp;quot;,  &amp;quot;United States&amp;quot;,  730),&#xA;                  );&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;fromArray($dataArray, NULL, &#39;A2&#39;);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（17）自动筛选&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//设置自动筛选&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setAutoFilter($objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;calculateWorksheetDimension());&#xA; //$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;calculateWorksheetDimension()     //得到A1行的所有内容&#xA;$autoFilter = $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getAutoFilter();    //获取自动筛选，用于增加删选条件&#xA;$autoFilter-&amp;gt;getColumn(&#39;C&#39;)&#xA;    -&amp;gt;setFilterType(PHPExcel_Worksheet_AutoFilter_Column::AUTOFILTER_FILTERTYPE_CUSTOMFILTER)&#xA;    -&amp;gt;createRule()&#xA;    -&amp;gt;setRule(&#xA;      PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_COLUMN_RULE_EQUAL,&#xA;      &#39;u*&#39;          //u 开头，  * =&amp;gt; 通配符&#xA;    )&#xA;    -&amp;gt;setRuleType(PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_RULETYPE_CUSTOMFILTER);&#xA;$autoFilter-&amp;gt;getColumn(&#39;C&#39;)&#xA;    -&amp;gt;createRule()&#xA;    -&amp;gt;setRule(&#xA;      PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_COLUMN_RULE_EQUAL,&#xA;      &#39;japan&#39;       // 为japan&#xA;    )&#xA;    -&amp;gt;setRuleType(PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_RULETYPE_CUSTOMFILTER);&#xA;$autoFilter-&amp;gt;getColumn(&#39;E&#39;)&#xA;    -&amp;gt;setFilterType(PHPExcel_Worksheet_AutoFilter_Column::AUTOFILTER_FILTERTYPE_FILTER)&#xA;    -&amp;gt;createRule()&#xA;    -&amp;gt;setRule(&#xA;      PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_COLUMN_RULE_EQUAL,&#xA;      &#39;&#39;        //只显示是空白的&#xA;    );&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（18）单元格值范围设定 &amp;amp;&amp;amp; 下拉菜单&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//设置单元格值的范围&#xA;$objValidation = $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getCell(&#39;B3&#39;)-&amp;gt;getDataValidation();&#xA;$objValidation-&amp;gt;setType( PHPExcel_Cell_DataValidation::TYPE_WHOLE );      //whole类&#xA;$objValidation-&amp;gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_STOP );    //错误级别&#xA;$objValidation-&amp;gt;setAllowBlank(true);&#xA;$objValidation-&amp;gt;setShowInputMessage(true);      //设置显示提示信息&#xA;$objValidation-&amp;gt;setShowErrorMessage(true);      //设置显示错误信息&#xA;$objValidation-&amp;gt;setErrorTitle(&#39;Input error&#39;);   //错误标题&#xA;$objValidation-&amp;gt;setError(&#39;Only numbers between 10 and 20 are allowed!&#39;);&#xA;$objValidation-&amp;gt;setPromptTitle(&#39;Allowed input&#39;);&#xA;$objValidation-&amp;gt;setPrompt(&#39;Only numbers between 10 and 20 are allowed.&#39;);&#xA;$objValidation-&amp;gt;setFormula1(10);      //设置最大值&#xA;$objValidation-&amp;gt;setFormula2(20);      //设置最小值&#xA;//或者这样设置  $objValidation-&amp;gt;setFormula2(1,5,6,7);  设置值是1，5，6，7中的一个数&#xA;&#xA;$objValidation = $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getCell(&#39;B5&#39;)-&amp;gt;getDataValidation();&#xA;$objValidation-&amp;gt;setType( PHPExcel_Cell_DataValidation::TYPE_LIST );     //list类&#xA;$objValidation-&amp;gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_INFORMATION );     &#xA;$objValidation-&amp;gt;setAllowBlank(false);&#xA;$objValidation-&amp;gt;setShowInputMessage(true);&#xA;$objValidation-&amp;gt;setShowErrorMessage(true);&#xA;$objValidation-&amp;gt;setShowDropDown(true);        //下拉菜单&#xA;$objValidation-&amp;gt;setErrorTitle(&#39;Input error&#39;);&#xA;$objValidation-&amp;gt;setError(&#39;Value is not in list.&#39;);&#xA;$objValidation-&amp;gt;setPromptTitle(&#39;Pick from list&#39;);&#xA;$objValidation-&amp;gt;setPrompt(&#39;Please pick a value from the drop-down list.&#39;);&#xA;$objValidation-&amp;gt;setFormula1(&#39;&amp;quot;Item A,Item B,Item C&amp;quot;&#39;);  //下拉菜单内容为   Item A,Item B,Item C&#xA;&#xA;&#xA;$objValidation = $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getCell(&#39;B7&#39;)-&amp;gt;getDataValidation();&#xA;$objValidation-&amp;gt;setType( PHPExcel_Cell_DataValidation::TYPE_LIST );&#xA;$objValidation-&amp;gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_INFORMATION );&#xA;$objValidation-&amp;gt;setAllowBlank(false);&#xA;$objValidation-&amp;gt;setShowInputMessage(true);&#xA;$objValidation-&amp;gt;setShowErrorMessage(true);&#xA;$objValidation-&amp;gt;setShowDropDown(true);&#xA;$objValidation-&amp;gt;setErrorTitle(&#39;Input error&#39;);&#xA;$objValidation-&amp;gt;setError(&#39;Value is not in list.&#39;);&#xA;$objValidation-&amp;gt;setPromptTitle(&#39;Pick from list&#39;);&#xA;$objValidation-&amp;gt;setPrompt(&#39;Please pick a value from the drop-down list.&#39;);&#xA;$objValidation-&amp;gt;setFormula1(&#39;$D$2:$D$6&#39;); //下拉菜单内容为 D2  - D6 &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（19）自动转换&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getStyle( &#39;B5&#39;)-&amp;gt;getAlignment()-&amp;gt;setShrinkToFit(true); //自动转换显示字体大小,使内容能够显示 字体大小变小&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getCell(B14)-&amp;gt;getValue();           //获得值，有可能得到的是公式&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;getCell(B14)-&amp;gt;getCalculatedValue();//获得算出的值&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（20）导入 &amp;amp;&amp;amp; 读取&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//导入，读取&#xA;//通过PHPExcel_IOFactory::load方法来载入一个文件，load会自动判断文件的后缀名来导入相应的处理类，读取格式保含xlsx/xls/xlsm/ods/slk/csv/xml/gnumeric&#xA;require_once &#39;../Classes/PHPExcel/IOFactory.php&#39;;&#xA;$objPHPExcel = PHPExcel_IOFactory::load(&#xA;//把载入的文件默认表（一般都是第一个）通过toArray方法来返回一个多维数组&#xA;$dataArray = $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;toArray();&#xA;//读完直接写到一个xlsx文件里&#xA;$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, &#39;Excel2007&#39;); //$objPHPExcel是上文中读的资源&#xA;$objWriter-&amp;gt;save(str_replace(&#39;.php&#39;, &#39;.xlsx&#39;, __FILE__));&#xA;&#xA;&#xA;//读取xml文件&#xA;$objReader = PHPExcel_IOFactory:: createReader(&#39;Excel2003XML&#39; );&#xA;$objPHPExcel = $objReader-&amp;gt;load( &amp;quot;Excel2003XMLTest.xml&amp;quot; );&#xA;&#xA;//读取ods文件&#xA;$objReader = PHPExcel_IOFactory:: createReader(&#39;OOCalc&#39; );&#xA;$objPHPExcel = $objReader-&amp;gt;load(&amp;quot;OOCalcTest.ods&amp;quot; );&#xA;&#xA;//读取numeric文件&#xA;$objReader = PHPExcel_IOFactory:: createReader(&#39;Gnumeric&#39; );&#xA;$objPHPExcel = $objReader-&amp;gt;load( &amp;quot;GnumericTest.gnumeric&amp;quot; );&#xA;&#xA;//读取slk文件&#xA;$objPHPExcel = PHPExcel_IOFactory:: load(&amp;quot;SylkTest.slk&amp;quot; );&#xA;&#xA;//循环遍历数据&#xA;$objReader = PHPExcel_IOFactory::createReader(&#39;Excel2007&#39; ); //创建一个2007的读取对象&#xA;$objPHPExcel = $objReader-&amp;gt;load (&amp;quot;05featuredemo.xlsx&amp;quot; );             //读取一个xlsx文件&#xA;foreach ($objPHPExcel-&amp;gt;getWorksheetIterator() as $worksheet) {     //遍历工作表&#xA;       echo &#39;Worksheet - &#39; , $worksheet-&amp;gt;getTitle() , PHP_EOL;&#xA;       foreach ($worksheet-&amp;gt;getRowIterator() as $row) {       //遍历行&#xA;             echo &#39;    Row number - &#39; , $row-&amp;gt;getRowIndex() , PHP_EOL;&#xA;            $cellIterator = $row-&amp;gt;getCellIterator();   //得到所有列&#xA;            $cellIterator-&amp;gt;setIterateOnlyExistingCells( false); // Loop all cells, even if it is not set&#xA;             foreach ($cellIterator as $cell) {  //遍历列&#xA;                   if (!is_null($cell)) {  //如果列不给空就得到它的坐标和计算的值&#xA;                         echo &#39;        Cell - &#39; , $cell-&amp;gt;getCoordinate() , &#39; - &#39; , $cell-&amp;gt;getCalculatedValue() , PHP_EOL;&#xA;                  }&#xA;            }&#xA;      }&#xA;}&#xA;//数组插入的表中&#xA;$data = array( array(&#39;title&#39;      =&amp;gt; &#39;Excel for dummies&#39;,&#xA;                     &#39;price&#39;      =&amp;gt; 17.99,&#xA;                     &#39;quantity&#39;   =&amp;gt; 2&#xA;                     ),&#xA;              array(&#39;title&#39;       =&amp;gt; &#39;PHP for dummies&#39;,&#xA;                     &#39;price&#39;      =&amp;gt; 15.99,&#xA;                     &#39;quantity&#39;  =&amp;gt; 1&#xA;                     ),&#xA;              array(&#39;title&#39;      =&amp;gt; &#39;Inside OOP&#39;,&#xA;                     &#39;price&#39;      =&amp;gt; 12.95,&#xA;                     &#39;quantity&#39;  =&amp;gt; 1&#xA;                     )&#xA;             );&#xA;$baseRow = 5;      //指定插入到第5行后&#xA;foreach($data as $r =&amp;gt; $dataRow) {&#xA;      $row = $baseRow + $r;    //$row是循环操作行的行号&#xA;      //在操作行的号前加一空行，这空行的行号就变成了当前的行号&#xA;      $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;insertNewRowBefore($row,1);   &#xA;       //对应的列都附上数据和编号&#xA;      $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue( &#39;A&#39;.$row, $r+1);     &#xA;      $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue( &#39;B&#39;.$row, $dataRow[&#39;title&#39;]);&#xA;      $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue( &#39;C&#39;.$row, $dataRow[&#39;price&#39;]);&#xA;      $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue( &#39;D&#39;.$row, $dataRow[&#39;quantity&#39;]);&#xA;      $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue( &#39;E&#39;.$row, &#39;=C&#39;.$row.&#39;*D&#39; .$row);&#xA;}&#xA;//最后删去第4行，这是示例需要，在此处为大家提供删除实例&#xA;$objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;removeRow($baseRow-1,1);     &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（21）处理中文输出问题&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//处理中文输出问题&#xA;//需要将字符串转化为UTF-8编码，才能正常输出，否则中文字符将输出为空白，如下处理：&#xA;$str  = iconv(&#39;gb2312&#39;, &#39;utf-8&#39;, $str);&#xA;//或者写一个函数专门处理中文字符串：&#xA;function convertUTF8($str)&#xA;{&#xA;   if(empty($str)) return &#39;&#39;;&#xA;   return  iconv(&#39;gb2312&#39;, &#39;utf-8&#39;, $str);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（22）数据库输出数据处理&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//从数据库输出数据处理方式&#xA;//从数据库读取数据如：&#xA;$db = new Mysql($dbconfig);&#xA;$sql = &amp;quot;SELECT * FROM  表名&amp;quot;;&#xA;$row = $db-&amp;gt;GetAll($sql);  // $row 为二维数组&#xA;$count = count($row);&#xA;for ($i = 2; $i &amp;lt;= $count+1; $i++) {&#xA; $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;A&#39; . $i, convertUTF8($row[$i-2][1]));&#xA; $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;B&#39; . $i, convertUTF8($row[$i-2][2]));&#xA; $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;C&#39; . $i, convertUTF8($row[$i-2][3]));&#xA; $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;D&#39; . $i, convertUTF8($row[$i-2][4]));&#xA; $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;E&#39; . $i, convertUTF8(date(&amp;quot;Y-m-d&amp;quot;, $row[$i-2][5])));&#xA; $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;F&#39; . $i, convertUTF8($row[$i-2][6]));&#xA; $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;G&#39; . $i, convertUTF8($row[$i-2][7]));&#xA; $objPHPExcel-&amp;gt;getActiveSheet()-&amp;gt;setCellValue(&#39;H&#39; . $i, convertUTF8($row[$i-2][8]));&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（23）数据库输出数据处理&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;//转CSV文件&#xA;看官方样例  &lt;code&gt;16csv.php&lt;/code&gt;&#xA;//转HTML文件&#xA;看官方样例  &lt;code&gt;17html.php&lt;/code&gt;&#xA;//命名区域&#xA;看官方样例  &lt;code&gt;19namedrange.php&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;（24）循环输出&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;// 循环输出&#xA;28iterator.php&#xA;$objReader = PHPExcel_IOFactory::createReader(&#39;Excel2007&#39;);&#xA;$objPHPExcel = $objReader-&amp;gt;load(&amp;quot;05featuredemo.xlsx&amp;quot;);&#xA;&#xA;echo date(&#39;H:i:s&#39;) , &amp;quot; Iterate worksheets&amp;quot; , EOL;&#xA;foreach ($objPHPExcel-&amp;gt;getWorksheetIterator() as $worksheet) {&#xA;  echo &#39;Worksheet - &#39; , $worksheet-&amp;gt;getTitle() , EOL;&#xA;&#xA;  foreach ($worksheet-&amp;gt;getRowIterator() as $row) {&#xA;    echo &#39;    Row number - &#39; , $row-&amp;gt;getRowIndex() , EOL;&#xA;&#xA;    $cellIterator = $row-&amp;gt;getCellIterator();&#xA;    $cellIterator-&amp;gt;setIterateOnlyExistingCells(false); // Loop all cells, even if it is not set&#xA;    foreach ($cellIterator as $cell) {&#xA;      if (!is_null($cell)) {&#xA;        echo &#39;        Cell - &#39; , $cell-&amp;gt;getCoordinate() , &#39; - &#39; , $cell-&amp;gt;getCalculatedValue() , EOL;&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（25）保存&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;//保存&#xA;$objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel);&#xA;$objWriter-&amp;gt;save(str_replace(&#39;.php&#39;, &#39;.xlsx&#39;, __FILE__));&#xA;//保存&#xA;require_once(&#39;Classes/PHPExcel/Writer/Excel5.php&#39;);&#xA;$objWriter = new PHPExcel_Writer_Excel5($objPHPExcel);&#xA;$objWriter-&amp;gt;save(str_replace(&#39;.php&#39;, &#39;.xls&#39;, __FILE__));&#xA;&#xA;//1.6.2新版保存&#xA;require_once(&#39;Classes/PHPExcel/IOFactory.php&#39;);&#xA;$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, &#39;Excel2007&#39;);&#xA;$objWriter-&amp;gt;save(str_replace(&#39;.php&#39;, &#39;.xls&#39;, __FILE__));&#xA;$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, &#39;Excel5&#39;);&#xA;$objWriter-&amp;gt;save(str_replace(&#39;.php&#39;, &#39;.xls&#39;, __FILE__));&#xA;&#xA;// 从浏览器直接输出$filename&#xA;header(&amp;quot;Pragma: public&amp;quot;);&#xA;header(&amp;quot;Expires: 0&amp;quot;);&#xA;header(&amp;quot;Cache-Control:must-revalidate, post-check=0, pre-check=0&amp;quot;);&#xA;header(&amp;quot;Content-Type:application/force-download&amp;quot;);&#xA;header(&amp;quot;Content-Type: application/vnd.ms-excel;&amp;quot;);&#xA;header(&amp;quot;Content-Type:application/octet-stream&amp;quot;);&#xA;header(&amp;quot;Content-Type:application/download&amp;quot;);&#xA;header(&amp;quot;Content-Disposition:attachment;filename=&amp;quot;.$filename);&#xA;header(&amp;quot;Content-Transfer-Encoding:binary&amp;quot;);&#xA;$objWriter-&amp;gt;save(&amp;quot;php://output&amp;quot;); &#xA;&#xA;// 输出文档到页面  &#xA;header(&#39;Content-Type: application/vnd.ms-excel&#39;);  &#xA;header(&#39;Content-Disposition: attachment;filename=&amp;quot;test.xls&amp;quot;&#39;);  &#xA;header(&#39;Cache-Control: max-age=0&#39;);  &#xA;PHPExcel_IOFactory::createWriter($phpexcel, &#39;Excel5&#39;)-&amp;gt;save(&#39;php://output&#39;); &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;</content>
    <link href="http://aiqiyi.github.io/ink-blog-phpexcel.html"></link>
    <author>
      <name>言唸</name>
    </author>
  </entry>
  <entry>
    <title>PHP Web 开发基础</title>
    <updated>2016-01-28T14:24:00+08:00</updated>
    <id>tag:aiqiyi.github.io,2016-01-28:/ink-blog-phpweb.html</id>
    <content type="html">&lt;p&gt;PHP是动态类型的Web开发的脚本语言，PHP以页面文件作为加载和运行的单元，PHP现在有了Composer作为开发包管理。&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;1.使用Composer管理依赖&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;自从.NET开发用了Nuget管理程序集依赖，我就再也离不开它了，幸亏Java中也有Maven管理jar包，虽然开源中国的镜像太慢但还有ibiblio的镜像可用，PHP现在终于有了Composer（参考1）用来管理资源包。&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;（1）全局安装（参考2）&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;在指定安装目录中执行命令行：&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;php -r &amp;quot;readfile(&#39;https://getcomposer.org/installer&#39;);&amp;quot; | php&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;在指定安装目录中执行命令行：&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;echo @php &amp;quot;%~dp0composer.phar&amp;quot; %*&amp;gt;composer.bat&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;将指定安装目录添加到环境变量的系统变量Path中。&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;（2）项目安装&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;在项目目录中执行命令行：&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;php -r &amp;quot;readfile(&#39;https://getcomposer.org/installer&#39;);&amp;quot; | php&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;使用 composer.json 文件配置依赖。如配置PHP中常用的日志组件：&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;    &amp;quot;require&amp;quot;: {&#xA;        &amp;quot;monolog/monolog&amp;quot;: &amp;quot;1.0.*&amp;quot;&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;这会将生成 &lt;code&gt;composer.lock&lt;/code&gt; 文件并依赖下载资源包到 &lt;code&gt;vendor&lt;/code&gt; 目录,&lt;code&gt;composer.lock&lt;/code&gt; 文件是下载依赖时真正使用的文件。&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;（3）升级依赖&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;项目使用 &lt;code&gt;composer.lock&lt;/code&gt; 文件维护依赖，如果我们需要使用更新版本的依赖，需要按需修改 &lt;code&gt;composer.json&lt;/code&gt; 文件并执行更新命令。全局安装：&lt;code&gt;composer update&lt;/code&gt;，项目安装使用：&lt;code&gt;php composer.phar update&lt;/code&gt;。&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;（4）资源包查询与镜像&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;可以使用&lt;code&gt;http://packagist.org&lt;/code&gt;检索资源包，好比.NET中的&lt;code&gt;https://www.nuget.org/packages/&lt;/code&gt;和Java中的&lt;code&gt;http://search.maven.org/&lt;/code&gt;。&lt;/p&gt;&#xA;&#xA;&lt;p&gt;可以使用&lt;code&gt;http://packagist.phpcomposer.com&lt;/code&gt;镜像，全局配置使用如下命令行命令：&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;composer config -g repo.packagist composer http://packagist.phpcomposer.com&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;项目配置使用如下命令行：&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;composer config repo.packagist composer http://packagist.phpcomposer.com&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;当然最简单的方式是直接修改composer.config文件：&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;    &amp;quot;require&amp;quot;: {&#xA;        &amp;quot;monolog/monolog&amp;quot;: &amp;quot;1.0.*&amp;quot;&#xA;    },&#xA;    &amp;quot;repositories&amp;quot;: {&#xA;        &amp;quot;packagist&amp;quot;: {&#xA;            &amp;quot;type&amp;quot;: &amp;quot;composer&amp;quot;,&#xA;            &amp;quot;url&amp;quot;: &amp;quot;http://packagist.phpcomposer.com&amp;quot;&#xA;        }&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;（5）自动加载&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;Composert 在 vendor 目录下自动生成并维护包含了全部依赖信息的 &lt;code&gt;autoload.php&lt;/code&gt; 文件。因此我们只需要通过 &lt;code&gt;autoload.php&lt;/code&gt; 使用第三方库即可。例如：&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php &#xA;require &#39;vendor/autoload.php&#39;;&#xA;$log = new Monolog\Logger(&#39;name&#39;);&#xA;$log-&amp;gt;pushHandler(new Monolog\Handler\StreamHandler(&#39;app.log&#39;, Monolog\Logger::WARNING));&#xA;$log-&amp;gt;addWarning(&#39;Foo&#39;);&#xA;?&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h2&gt;2.PHP基础&lt;/h2&gt;&#xA;&#xA;&lt;h4&gt;（1）PHP类似C语系语法的脚本语言。&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;如果你有C或C++语言的基础，那么很多概念和语法都可以直接对照。从大小写敏感到注释，从数据类型、函数、参数传递和成员引用等。从C/C++/Java/C#这一体系学习下来，再加上JavaScript脚本语言的基础，加点PHP的技能点水到渠成。&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;（2）PHP是动态类型语言。&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;PHP有和C语言等强类型语言一样的数据类型定义，支持的类型也相仿，只是PHP中同一变量在不同时刻可以表示不同类型的数据，但同一时刻，每个变量都相当于强类型中的指定类型的变量。因此对于PHP，更适合的称呼是动态类型。习惯使用Java/C#等强类型语言总会对动态类型的脚本语言心存焦虑，可以通过PHP的类型检查函数减少这方面的顾虑（is_bool\is_integer\is_double\is_string\is_null等）。&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;（3）PHP以页面文件方式运行。&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;无论如何使用PHP，PHP的都是以页面文件方式运行的，这和运行在浏览器端的JavaScript方式类似，JavaScript文件只有在被加载到当前页面才能引用和执行，PHP也只有在通过include或required方式加载后才能引用和执行，即使后续添加的 __autoload和spl_autoload依然只是简化而非改变了其加载引用的本质。&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;（4）PHP不需要复杂的框架&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;PHP天生是处理Web请求的，HTTP协议相关的内容是PHP的重点，一般来讲，除了纵向请求的处理，横向的认证和授权控制部分，其他部分不应该过于依赖PHP，如果通过耦合性较高的Web框架使用PHP本身就是错误的。由于PHP本身的运行和加载方式，导致PHP天生就适合复用各种组件而非使用框架来解决问题。成天寄希望于框架的人，要么是不想在PHP基础要么是不想在业务逻辑基础上下功夫。&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;3.PHP常用文件&lt;/h2&gt;&#xA;&#xA;&lt;h4&gt;（1）配置文件config.php&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;应用配置的各种信息定义在一个或多个配置文件中。一般每次请求都会加载配置文件，配置文件中不只包含了数据库连接信息，如应用MVC时，每次请求都会加载配置文件以便读取所有URL和Controller以及View之间的规则。&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;（2）入口文件index.php&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;处理首页请求或全部请求的文件。index.php在实现PHP的MVC时是天然的前段控制器FrontController，由index.php负责纵向的处理请求转发，横向的认证和授权等处理文件，等也需要在index.php中加载。&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;（3）数据访问文件database.php&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;database.php&lt;/strong&gt;是工具类中最主要的用于数据访问的文件，为了避免数据访问中重复性出现的代码，一般的PHP应用程序都会独立的一个或一组数据访问文件。&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;4.自定义Session&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;在PHP中自定义&lt;strong&gt;Session&lt;/strong&gt;比Java中方便多了，只需要将自定义的函数名称做为参数传递给&lt;code&gt;session_set_save_handler&lt;/code&gt;($open, $close, $read, $write, $destroy, $gc)作为参数即可，我们自定义一个使用cookie作为存储的session，作为演示没有对数据长度进行验证，也没有使用对称加密解密。&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;&#xA;function open_session() {&#xA;    return true;&#xA;}&#xA;&#xA;function close_session() {&#xA;    return true;&#xA;}&#xA;&#xA;function read_session($id) {&#xA;    if ($_COOKIE[$id]) {&#xA;        return base64_decode($_COOKIE[$id]);&#xA;    }&#xA;    return &#39;&#39;;&#xA;}&#xA;&#xA;function write_session($sid, $data) {&#xA;    if ($_COOKIE[&#39;session_end&#39;]) {&#xA;        setcookie($sid, base64_encode($data), $_COOKIE[&#39;session_end&#39;]);&#xA;    } else {&#xA;        $start = time() + session_get_cookie_params()[&#39;lifetime&#39;];&#xA;        setcookie(&#39;session_end&#39;, $start, $start);&#xA;        setcookie($sid, base64_encode($data), $start);&#xA;    }&#xA;    return true;&#xA;}&#xA;&#xA;function destroy_session() {&#xA;    $_Session = array();&#xA;    return true;&#xA;}&#xA;&#xA;function gc_session() {&#xA;    return true;&#xA;}&#xA;&#xA;ini_set(&amp;quot;session.cookie_lifetime&amp;quot;, &amp;quot;3600&amp;quot;);&#xA;session_set_save_handler(&#39;open_session&#39;, &#39;close_session&#39;, &#39;read_session&#39;, &#39;write_session&#39;, &#39;destroy_session&#39;, &#39;gc_session&#39;);&#xA;session_start();&#xA;$_SESSION[&#39;count&#39;] += 1;&#xA;echo $_SESSION[&#39;count&#39;];&#xA;session_write_close();&#xA;?&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;</content>
    <link href="http://aiqiyi.github.io/ink-blog-phpweb.html"></link>
    <author>
      <name>言唸</name>
    </author>
  </entry>
  <entry>
    <title>简洁的静态博客构建工具 —— 纸小墨（InkPaper）</title>
    <updated>2015-11-06T10:00:00+08:00</updated>
    <id>tag:aiqiyi.github.io,2015-11-06:/ink-blog-tool.html</id>
    <content type="html">&lt;h2&gt;纸小墨简介&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;纸小墨（InkPaper）是一个使用GO语言编写的静态博客构建工具，可以快速搭建博客网站。优点是无依赖跨平台，配置简单构建快速，注重于简洁易用与排版优化。&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;img src=&#34;data:image/gif;base64,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&#34; data-src=&#34;/images/example.png&#34; alt=&#34;纸小墨 - 简洁的静态博客构建工具&#34; /&gt;&lt;/p&gt;&#xA;&#xA;&lt;h3&gt;开始上手&lt;/h3&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;下载并解压 &lt;a href=&#34;http://www.inkpaper.io/&#34;&gt;Ink&lt;/a&gt;，运行命令 &lt;code&gt;ink preview&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;使用浏览器访问 &lt;code&gt;http://localhost:8000&lt;/code&gt; 预览&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;h3&gt;配置网站&lt;/h3&gt;&#xA;&#xA;&lt;p&gt;编辑&lt;code&gt;config.yml&lt;/code&gt;，使用如下格式&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is an example of AppleScript:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;quot;footer&amp;quot;&amp;gt;&#xA;    &amp;amp;copy; 2004 Foo Corporation&#xA;&amp;lt;/div&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&#34;mailto:15868122554@163.com&#34;&gt;15868122554@163.com&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Please don&amp;rsquo;t use any &lt;code&gt;&amp;lt;blink&amp;gt;&lt;/code&gt; tags.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;There is a literal backtick (`) here.&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Use the &lt;code&gt;printf()&lt;/code&gt; function.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;*this text is surrounded by literal asterisks*&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;em&gt;single asterisks&lt;/em&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;em&gt;single underscores&lt;/em&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;double asterisks&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;double underscores&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I get 10 times more traffic from &lt;a href=&#34;http://google.com/&#34; title=&#34;Google&#34;&gt;Google&lt;/a&gt; than from&#xA;&lt;a href=&#34;http://search.yahoo.com/&#34; title=&#34;Yahoo Search&#34;&gt;Yahoo&lt;/a&gt; or &lt;a href=&#34;http://search.msn.com/&#34; title=&#34;MSN Search&#34;&gt;MSN&lt;/a&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This is &lt;a href=&#34;http://example.com/&#34; title=&#34;Title&#34;&gt;an example&lt;/a&gt; inline link.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&#34;http://example.net/&#34;&gt;This link&lt;/a&gt; has no title attribute.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;See my &lt;a href=&#34;/about/&#34;&gt;About&lt;/a&gt; page for details.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;site:&#xA;    title: 网站标题&#xA;    subtitle: 网站子标题&#xA;    limit: 每页可显示的文章数目&#xA;    theme: 网站主题目录&#xA;    comment: 评论插件变量(默认为Disqus账户名)&#xA;    root: 网站根路径 #可选&#xA;    lang: 网站语言 #支持en, zh，可在theme/lang.yml配置&#xA;    url: 网站链接 #用于RSS生成&#xA;    link: 文章链接形式 #默认为{title}.html，支持{year},{month},{day},{title}变量&#xA;&#xA;authors:&#xA;    作者ID:&#xA;        name: 作者名称&#xA;        intro: 作者简介&#xA;        avatar: 作者头像路径&#xA;&#xA;build:&#xA;    port: 预览端口&#xA;    copy:&#xA;        - 构建时将会复制的目录/文件&#xA;    publish: |&#xA;        ink publish 命令将会执行的脚本&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h3&gt;创建文章&lt;/h3&gt;&#xA;&#xA;&lt;p&gt;在&lt;code&gt;source&lt;/code&gt;目录中建立任意&lt;code&gt;.md&lt;/code&gt;文件（可置于子文件夹），使用如下格式&lt;/p&gt;&#xA;&#xA;&lt;p&gt;``` yaml&#xA;title: 文章标题&#xA;date: 年-月-日 时:分:秒 #创建时间，可加时区如&amp;rdquo; +0800&amp;rdquo;&#xA;update: 年-月-日 时:分:秒 #更新时间，可选，可加时区如&amp;rdquo; +0800&amp;rdquo;&#xA;author: 作者ID&#xA;cover: 题图链接 #可选&#xA;draft: false #草稿，可选&#xA;top: false #置顶文章，可选&#xA;preview: 文章预览，也可在正文中使用&lt;!--more--&gt;分割 #可选&#xA;tags: #可选&#xA;    - 标签1&#xA;    - 标签2&lt;/p&gt;&#xA;</content>
    <link href="http://aiqiyi.github.io/ink-blog-tool.html"></link>
    <author>
      <name>言唸</name>
    </author>
  </entry>
  <entry>
    <title>An Elegant Static Blog Generator —— InkPaper</title>
    <updated>2015-11-06T10:00:00+08:00</updated>
    <id>tag:aiqiyi.github.io,2015-11-06:/ink-blog-tool-en.html</id>
    <content type="html">&lt;h2&gt;Introduce&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;InkPaper is an static blog generator developed by Golang, No dependencies, Cross platform, Easy use, Fast build, Elegant theme.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;img src=&#34;data:image/gif;base64,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&#34; data-src=&#34;/images/example-en.png&#34; alt=&#34;InkPaper - An Elegant Static Blog Generator&#34; /&gt;&lt;/p&gt;&#xA;&#xA;&lt;h3&gt;Quick Start&lt;/h3&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Download &amp;amp; Extract &lt;a href=&#34;http://www.inkpaper.io/&#34;&gt;Ink&lt;/a&gt;，Run &lt;code&gt;ink preview&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Open &lt;code&gt;http://localhost:8000&lt;/code&gt; in browser to preview&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;h3&gt;Website Configuration&lt;/h3&gt;&#xA;&#xA;&lt;p&gt;Edit &lt;code&gt;config.yml&lt;/code&gt;, use format:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;site:&#xA;    title: Website Title&#xA;    subtitle: Website Subtitle&#xA;    limit: Max Article Count Per Page&#xA;    theme: Website Theme Directory&#xA;    comment: Comment Plugin Variable (Default Is Disqus Username)&#xA;    root: Website Root Path #Optional&#xA;    lang: Website Language #Support en, zh, Configurable in theme/lang.yml&#xA;    url: Website URL #For RSS Generating&#xA;    link: Article Link Scheme #Default Is {title}.html，Support {year},{month},{day},{title} Variables&#xA;&#xA;authors:&#xA;    AuthorID:&#xA;        name: Author Name&#xA;        intro: Author Motto&#xA;        avatar: Author Avatar Path&#xA;&#xA;build:&#xA;    port: Preview Port&#xA;    copy:&#xA;        - Copied Files When Build&#xA;    publish: |&#xA;        Excuted command when use &#39;ink publish&#39;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h3&gt;Writing&lt;/h3&gt;&#xA;&#xA;&lt;p&gt;Create any &lt;code&gt;.md&lt;/code&gt; file in &lt;code&gt;source&lt;/code&gt; directory (Support subdirectory), use format:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;``` yaml&#xA;title: Article Title&#xA;date: Year-Month-Day Hour:Minute:Second #Created Time，Support TimeZone, such as &amp;ldquo; +0800&amp;rdquo;&#xA;update: Year-Month-Day Hour:Minute:Second #Updated Time，Optional，Support TimeZone, such as &amp;ldquo; +0800&amp;rdquo;&#xA;author: AuthorID&#xA;cover: Article Cover Path #Optional&#xA;draft: false #If Draft，Optional&#xA;top: false #Place article to top, Optional&#xA;preview: Article Preview，Also use &lt;!--more--&gt; to split in body #Optional&#xA;tags: #Optional&#xA;    - Tag1&#xA;    - Tag2&lt;/p&gt;&#xA;</content>
    <link href="http://aiqiyi.github.io/ink-blog-tool-en.html"></link>
    <author>
      <name>言唸</name>
    </author>
  </entry>
</feed>