<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1, minimum-scale=1, maximum-scale=1">
        <meta name="keywords" content="php,">
        <meta name="description" content="PHP Web 开发基础">
        <link rel="stylesheet" href="/bundle/index.css">
        <title>PHP Web 开发基础</title>
    </head>
    <body>
        <article class="container">
            <a class="index" href="/">PHP</a>
<ul class="menu">
    <li class="menu-item"><a href="/archive.html">归档</a></li>
    <li class="menu-item"><a href="/tag.html">标签</a></li>
    <li class="menu-item"><a href="/atom.xml">订阅</a></li>
</ul>
<script type="text/javascript">
    var timeSinceLang = {
        year: '年前',
        month: '个月前',
        day: '天前',
        hour: '小时前',
        minute: '分钟前',
        second: '秒前'
    };
</script>

<script type="text/javascript">
    var conn, reloadTimer, connectTimer;
    var connect = function() {
        conn = new WebSocket('ws://' + location.host + '/live');
        conn.onmessage = function(event) {
            if (event.data === 'change') {
                if (reloadTimer) clearTimeout(reloadTimer);
                reloadTimer = setTimeout(function() {
                    window.location.reload();
                }, 200);
            }
        };
        conn.onclose = function() {
            if (connectTimer) clearTimeout(connectTimer);
            connectTimer = setTimeout(function() {
                connect();
            }, 1000);
        };
    };
    connect();
</script>


            <article class="main article">
                <h1 class="title">PHP Web 开发基础</h1>
                <section class="info">
                    <span class="avatar" style="background-image: url(/images/avatar.jpg);"></span>
                    <a class="name" href="/about.me.html">言唸</a>
                    <span class="date" data-time="1453962240">
                        <span class="from"></span>
                        <span class="date" data-time="1453962240">(<span class="from"></span> 更新)</span>
                    </span>
                    <span class="tags"><a class="tag" href="/tag/php/index.html">php</a></span>
                </section>
                <article class="content"><p>PHP是动态类型的Web开发的脚本语言，PHP以页面文件作为加载和运行的单元，PHP现在有了Composer作为开发包管理。</p>

<h2>1.使用Composer管理依赖</h2>

<p>自从.NET开发用了Nuget管理程序集依赖，我就再也离不开它了，幸亏Java中也有Maven管理jar包，虽然开源中国的镜像太慢但还有ibiblio的镜像可用，PHP现在终于有了Composer（参考1）用来管理资源包。</p>

<h4>（1）全局安装（参考2）</h4>

<p>在指定安装目录中执行命令行：</p>

<pre><code>php -r &quot;readfile('https://getcomposer.org/installer');&quot; | php
</code></pre>

<p>在指定安装目录中执行命令行：</p>

<pre><code>echo @php &quot;%~dp0composer.phar&quot; %*&gt;composer.bat
</code></pre>

<p>将指定安装目录添加到环境变量的系统变量Path中。</p>

<h4>（2）项目安装</h4>

<p>在项目目录中执行命令行：</p>

<pre><code>php -r &quot;readfile('https://getcomposer.org/installer');&quot; | php
</code></pre>

<p>使用 composer.json 文件配置依赖。如配置PHP中常用的日志组件：</p>

<pre><code>{
    &quot;require&quot;: {
        &quot;monolog/monolog&quot;: &quot;1.0.*&quot;
    }
}
</code></pre>

<p>这会将生成 <code>composer.lock</code> 文件并依赖下载资源包到 <code>vendor</code> 目录,<code>composer.lock</code> 文件是下载依赖时真正使用的文件。</p>

<h4>（3）升级依赖</h4>

<p>项目使用 <code>composer.lock</code> 文件维护依赖，如果我们需要使用更新版本的依赖，需要按需修改 <code>composer.json</code> 文件并执行更新命令。全局安装：<code>composer update</code>，项目安装使用：<code>php composer.phar update</code>。</p>

<h4>（4）资源包查询与镜像</h4>

<p>可以使用<code>http://packagist.org</code>检索资源包，好比.NET中的<code>https://www.nuget.org/packages/</code>和Java中的<code>http://search.maven.org/</code>。</p>

<p>可以使用<code>http://packagist.phpcomposer.com</code>镜像，全局配置使用如下命令行命令：</p>

<pre><code>composer config -g repo.packagist composer http://packagist.phpcomposer.com
</code></pre>

<p>项目配置使用如下命令行：</p>

<pre><code>composer config repo.packagist composer http://packagist.phpcomposer.com
</code></pre>

<p>当然最简单的方式是直接修改composer.config文件：</p>

<pre><code>{
    &quot;require&quot;: {
        &quot;monolog/monolog&quot;: &quot;1.0.*&quot;
    },
    &quot;repositories&quot;: {
        &quot;packagist&quot;: {
            &quot;type&quot;: &quot;composer&quot;,
            &quot;url&quot;: &quot;http://packagist.phpcomposer.com&quot;
        }
    }
}
</code></pre>

<h4>（5）自动加载</h4>

<p>Composert 在 vendor 目录下自动生成并维护包含了全部依赖信息的 <code>autoload.php</code> 文件。因此我们只需要通过 <code>autoload.php</code> 使用第三方库即可。例如：</p>

<pre><code>&lt;?php 
require 'vendor/autoload.php';
$log = new Monolog\Logger('name');
$log-&gt;pushHandler(new Monolog\Handler\StreamHandler('app.log', Monolog\Logger::WARNING));
$log-&gt;addWarning('Foo');
?&gt;
</code></pre>

<h2>2.PHP基础</h2>

<h4>（1）PHP类似C语系语法的脚本语言。</h4>

<p>如果你有C或C++语言的基础，那么很多概念和语法都可以直接对照。从大小写敏感到注释，从数据类型、函数、参数传递和成员引用等。从C/C++/Java/C#这一体系学习下来，再加上JavaScript脚本语言的基础，加点PHP的技能点水到渠成。</p>

<h4>（2）PHP是动态类型语言。</h4>

<p>PHP有和C语言等强类型语言一样的数据类型定义，支持的类型也相仿，只是PHP中同一变量在不同时刻可以表示不同类型的数据，但同一时刻，每个变量都相当于强类型中的指定类型的变量。因此对于PHP，更适合的称呼是动态类型。习惯使用Java/C#等强类型语言总会对动态类型的脚本语言心存焦虑，可以通过PHP的类型检查函数减少这方面的顾虑（is_bool\is_integer\is_double\is_string\is_null等）。</p>

<h4>（3）PHP以页面文件方式运行。</h4>

<p>无论如何使用PHP，PHP的都是以页面文件方式运行的，这和运行在浏览器端的JavaScript方式类似，JavaScript文件只有在被加载到当前页面才能引用和执行，PHP也只有在通过include或required方式加载后才能引用和执行，即使后续添加的 __autoload和spl_autoload依然只是简化而非改变了其加载引用的本质。</p>

<h4>（4）PHP不需要复杂的框架</h4>

<p>PHP天生是处理Web请求的，HTTP协议相关的内容是PHP的重点，一般来讲，除了纵向请求的处理，横向的认证和授权控制部分，其他部分不应该过于依赖PHP，如果通过耦合性较高的Web框架使用PHP本身就是错误的。由于PHP本身的运行和加载方式，导致PHP天生就适合复用各种组件而非使用框架来解决问题。成天寄希望于框架的人，要么是不想在PHP基础要么是不想在业务逻辑基础上下功夫。</p>

<h2>3.PHP常用文件</h2>

<h4>（1）配置文件config.php</h4>

<p>应用配置的各种信息定义在一个或多个配置文件中。一般每次请求都会加载配置文件，配置文件中不只包含了数据库连接信息，如应用MVC时，每次请求都会加载配置文件以便读取所有URL和Controller以及View之间的规则。</p>

<h4>（2）入口文件index.php</h4>

<p>处理首页请求或全部请求的文件。index.php在实现PHP的MVC时是天然的前段控制器FrontController，由index.php负责纵向的处理请求转发，横向的认证和授权等处理文件，等也需要在index.php中加载。</p>

<h4>（3）数据访问文件database.php</h4>

<p><strong>database.php</strong>是工具类中最主要的用于数据访问的文件，为了避免数据访问中重复性出现的代码，一般的PHP应用程序都会独立的一个或一组数据访问文件。</p>

<h2>4.自定义Session</h2>

<p>在PHP中自定义<strong>Session</strong>比Java中方便多了，只需要将自定义的函数名称做为参数传递给<code>session_set_save_handler</code>($open, $close, $read, $write, $destroy, $gc)作为参数即可，我们自定义一个使用cookie作为存储的session，作为演示没有对数据长度进行验证，也没有使用对称加密解密。</p>

<pre><code>&lt;?php

function open_session() {
    return true;
}

function close_session() {
    return true;
}

function read_session($id) {
    if ($_COOKIE[$id]) {
        return base64_decode($_COOKIE[$id]);
    }
    return '';
}

function write_session($sid, $data) {
    if ($_COOKIE['session_end']) {
        setcookie($sid, base64_encode($data), $_COOKIE['session_end']);
    } else {
        $start = time() + session_get_cookie_params()['lifetime'];
        setcookie('session_end', $start, $start);
        setcookie($sid, base64_encode($data), $start);
    }
    return true;
}

function destroy_session() {
    $_Session = array();
    return true;
}

function gc_session() {
    return true;
}

ini_set(&quot;session.cookie_lifetime&quot;, &quot;3600&quot;);
session_set_save_handler('open_session', 'close_session', 'read_session', 'write_session', 'destroy_session', 'gc_session');
session_start();
$_SESSION['count'] += 1;
echo $_SESSION['count'];
session_write_close();
?&gt;
</code></pre>
</article>
                <section class="author">
                    <div class="avatar" style="background-image: url(/images/avatar.jpg);"></div>
                    <a class="name" href="/about.me.html">言唸</a>
                    <div class="intro">____phper</div>
                </section>
                <section class="recommend">
                    
                    <section class="nav prev more">
                        <div class="head">上篇文章</div>
                        <a class="link" href="/ink-blog-phpexcel.html">PHPExcel 用法详解</a>
                    </section>
                    
                    
                    <section class="nav next more">
                        <div class="head">下篇文章</div>
                        <a class="link" href="/ink-blog-tool.html">简洁的静态博客构建工具 —— 纸小墨（InkPaper）</a>
                    </section>
                    
                </section>
                
    <section id="disqus_thread"></section>
    <script type="text/javascript">
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//PHPer.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>


            </article>
        </article>
        <footer class="footer">
    <span class="copyright">
        PHP ©
        <script type="text/javascript">
            document.write(new Date().getFullYear());
        </script>
    </span>
    <span class="publish">Powered by <a href="http://www.inkpaper.io/" target="_blank">Ink</a></span>
</footer>

        <script src="/bundle/index.js"></script>
    </body>
</html>
